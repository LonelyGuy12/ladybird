<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Basic Test - Ladybird</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .test-result {
            margin: 10px 0;
            padding: 12px;
            border-radius: 6px;
            font-weight: 500;
        }
        
        .test-pass {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid #28a745;
        }
        
        .test-fail {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid #dc3545;
        }
        
        .test-pending {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
        }
        
        h1 { 
            color: #1a73e8; 
            text-align: center; 
            margin-bottom: 10px;
        }
        
        h2 { 
            color: #34a853; 
            margin-top: 0;
        }
        
        .summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            margin: 30px 0;
        }
        
        .summary h2 {
            color: white;
            margin: 0 0 15px 0;
        }
        
        .summary-stats {
            font-size: 1.5em;
            margin: 15px 0;
        }
        
        #test-results {
            min-height: 100px;
        }
    </style>
</head>
<body>
    <h1>ğŸ Python Basic Functionality Test</h1>
    <p style="text-align: center; color: #666;">Self-verifying tests - results appear below automatically</p>

    <div id="test-results">
        <div class="test-section">
            <div class="test-result test-pending">Waiting for Python tests to run...</div>
        </div>
    </div>

    <div class="summary" id="summary">
        <h2>Test Summary</h2>
        <div class="summary-stats" id="summary-stats">Running tests...</div>
    </div>

    <!-- Hidden storage element for test results -->
    <div id="python-test-storage" style="display: none;" data-test-count="0" data-test-passed="0" data-test-failed="0"></div>

    <!-- Python Scripts - Tests run and store results in DOM -->
    <script type="python">
# Test 1: Basic Arithmetic - 2+2=4
result = 2 + 2
if result == 4:
    # Store result in DOM
    storage = document.find("#python-test-storage")
    if storage:
        count = int(storage.get_attribute("data-test-count") or "0")
        passed = int(storage.get_attribute("data-test-passed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-passed", str(passed + 1))
        storage.set_attribute("data-test1-arithmetic", "PASS:2+2=4")
    print("âœ“ Test 1.1: 2 + 2 = 4")
else:
    if storage:
        count = int(storage.get_attribute("data-test-count") or "0")
        failed = int(storage.get_attribute("data-test-failed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-failed", str(failed + 1))
        storage.set_attribute("data-test1-arithmetic", f"FAIL:Expected 4, got {result}")
    print(f"âœ— Test 1.1: Expected 4, got {result}")
    </script>

    <script type="python">
# Test 2: More arithmetic
result2 = 10 * 5
storage = document.find("#python-test-storage")
if storage:
    count = int(storage.get_attribute("data-test-count") or "0")
    if result2 == 50:
        passed = int(storage.get_attribute("data-test-passed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-passed", str(passed + 1))
        storage.set_attribute("data-test1-multiplication", "PASS:10*5=50")
        print("âœ“ Test 1.2: 10 * 5 = 50")
    else:
        failed = int(storage.get_attribute("data-test-failed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-failed", str(failed + 1))
        storage.set_attribute("data-test1-multiplication", f"FAIL:Expected 50, got {result2}")
        print(f"âœ— Test 1.2: Expected 50, got {result2}")
    </script>

    <script type="python">
# Test 3: Division
result3 = 100 / 4
storage = document.find("#python-test-storage")
if storage:
    count = int(storage.get_attribute("data-test-count") or "0")
    if result3 == 25.0:
        passed = int(storage.get_attribute("data-test-passed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-passed", str(passed + 1))
        storage.set_attribute("data-test1-division", "PASS:100/4=25.0")
        print("âœ“ Test 1.3: 100 / 4 = 25.0")
    else:
        failed = int(storage.get_attribute("data-test-failed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-failed", str(failed + 1))
        storage.set_attribute("data-test1-division", f"FAIL:Expected 25.0, got {result3}")
        print(f"âœ— Test 1.3: Expected 25.0, got {result3}")
    </script>

    <script type="python">
# Test 4: Lists
numbers = [1, 2, 3, 4, 5]
storage = document.find("#python-test-storage")
if storage:
    count = int(storage.get_attribute("data-test-count") or "0")
    if len(numbers) == 5:
        passed = int(storage.get_attribute("data-test-passed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-passed", str(passed + 1))
        storage.set_attribute("data-test2-list-length", "PASS:List has 5 items")
        print("âœ“ Test 2.1: List length = 5")
    else:
        failed = int(storage.get_attribute("data-test-failed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-failed", str(failed + 1))
        storage.set_attribute("data-test2-list-length", f"FAIL:Expected 5, got {len(numbers)}")
        print(f"âœ— Test 2.1: Expected length 5, got {len(numbers)}")
    </script>

    <script type="python">
# Test 5: List comprehension
squares = [x**2 for x in [1, 2, 3, 4, 5]]
expected = [1, 4, 9, 16, 25]
storage = document.find("#python-test-storage")
if storage:
    count = int(storage.get_attribute("data-test-count") or "0")
    if squares == expected:
        passed = int(storage.get_attribute("data-test-passed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-passed", str(passed + 1))
        storage.set_attribute("data-test2-list-comprehension", "PASS:List comprehension works")
        print("âœ“ Test 2.2: List comprehension works")
    else:
        failed = int(storage.get_attribute("data-test-failed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-failed", str(failed + 1))
        storage.set_attribute("data-test2-list-comprehension", f"FAIL:Expected {expected}, got {squares}")
        print(f"âœ— Test 2.2: Expected {expected}, got {squares}")
    </script>

    <script type="python">
# Test 6: Dictionary
person = {"name": "Python", "version": "3.x"}
storage = document.find("#python-test-storage")
if storage:
    count = int(storage.get_attribute("data-test-count") or "0")
    if person.get("name") == "Python":
        passed = int(storage.get_attribute("data-test-passed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-passed", str(passed + 1))
        storage.set_attribute("data-test2-dict", "PASS:Dictionary access works")
        print("âœ“ Test 2.3: Dictionary access works")
    else:
        failed = int(storage.get_attribute("data-test-failed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-failed", str(failed + 1))
        storage.set_attribute("data-test2-dict", "FAIL:Dictionary access failed")
        print("âœ— Test 2.3: Dictionary access failed")
    </script>

    <script type="python">
# Test 7: Control Flow - Loop
total = 0
for i in range(10):
    if i % 2 == 0:
        total += i
# Sum of even numbers 0-9: 0+2+4+6+8 = 20
storage = document.find("#python-test-storage")
if storage:
    count = int(storage.get_attribute("data-test-count") or "0")
    if total == 20:
        passed = int(storage.get_attribute("data-test-passed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-passed", str(passed + 1))
        storage.set_attribute("data-test3-loop", "PASS:For loop with conditionals works")
        print("âœ“ Test 3.1: For loop with conditionals works")
    else:
        failed = int(storage.get_attribute("data-test-failed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-failed", str(failed + 1))
        storage.set_attribute("data-test3-loop", f"FAIL:Expected 20, got {total}")
        print(f"âœ— Test 3.1: Expected 20, got {total}")
    </script>

    <script type="python">
# Test 8: Functions
def add(a, b):
    return a + b

result = add(3, 4)
storage = document.find("#python-test-storage")
if storage:
    count = int(storage.get_attribute("data-test-count") or "0")
    if result == 7:
        passed = int(storage.get_attribute("data-test-passed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-passed", str(passed + 1))
        storage.set_attribute("data-test4-function", "PASS:Function definition and call works")
        print("âœ“ Test 4.1: Function definition and call works")
    else:
        failed = int(storage.get_attribute("data-test-failed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-failed", str(failed + 1))
        storage.set_attribute("data-test4-function", f"FAIL:Expected 7, got {result}")
        print(f"âœ— Test 4.1: Expected 7, got {result}")
    </script>

    <script type="python">
# Test 9: String Operations
text = "Ladybird"
storage = document.find("#python-test-storage")
if storage:
    count = int(storage.get_attribute("data-test-count") or "0")
    if len(text) == 8:
        passed = int(storage.get_attribute("data-test-passed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-passed", str(passed + 1))
        storage.set_attribute("data-test5-string", "PASS:String operations work")
        print("âœ“ Test 5.1: String operations work")
    else:
        failed = int(storage.get_attribute("data-test-failed") or "0")
        storage.set_attribute("data-test-count", str(count + 1))
        storage.set_attribute("data-test-failed", str(failed + 1))
        storage.set_attribute("data-test5-string", f"FAIL:Expected length 8, got {len(text)}")
        print(f"âœ— Test 5.1: Expected length 8, got {len(text)}")
    </script>

    <script type="python">
# Mark tests as complete
storage = document.find("#python-test-storage")
if storage:
    storage.set_attribute("data-tests-complete", "true")
    print("All tests completed!")
    </script>

    <!-- JavaScript to display results -->
    <script>
        function displayTestResults() {
            const storage = document.getElementById('python-test-storage');
            if (!storage) {
                setTimeout(displayTestResults, 100);
                return;
            }
            
            const isComplete = storage.getAttribute('data-tests-complete') === 'true';
            if (!isComplete) {
                setTimeout(displayTestResults, 200);
                return;
            }
            
            const testCount = parseInt(storage.getAttribute('data-test-count') || '0');
            const passed = parseInt(storage.getAttribute('data-test-passed') || '0');
            const failed = parseInt(storage.getAttribute('data-test-failed') || '0');
            
            const resultsDiv = document.getElementById('test-results');
            const summaryStats = document.getElementById('summary-stats');
            
            // Get all test attributes
            const testResults = {};
            for (let attr of storage.attributes) {
                if (attr.name.startsWith('data-test') && attr.name !== 'data-test-count' && 
                    attr.name !== 'data-test-passed' && attr.name !== 'data-test-failed' &&
                    attr.name !== 'data-tests-complete') {
                    const testName = attr.name.replace('data-test', '').replace(/-/g, ' ');
                    const [status, ...details] = attr.value.split(':');
                    testResults[attr.name] = {
                        name: testName,
                        passed: status === 'PASS',
                        details: details.join(':')
                    };
                }
            }
            
            // Display individual test results
            const testNames = {
                'data-test1-arithmetic': 'Test 1.1: Basic Addition (2+2=4)',
                'data-test1-multiplication': 'Test 1.2: Multiplication (10*5=50)',
                'data-test1-division': 'Test 1.3: Division (100/4=25)',
                'data-test2-list-length': 'Test 2.1: List Length',
                'data-test2-list-comprehension': 'Test 2.2: List Comprehension',
                'data-test2-dict': 'Test 2.3: Dictionary Access',
                'data-test3-loop': 'Test 3.1: For Loop with Conditionals',
                'data-test4-function': 'Test 4.1: Function Definition & Call',
                'data-test5-string': 'Test 5.1: String Operations'
            };
            
            let html = '';
            for (const [key, result] of Object.entries(testResults)) {
                const testName = testNames[key] || result.name;
                const className = result.passed ? 'test-pass' : 'test-fail';
                const icon = result.passed ? 'âœ“' : 'âœ—';
                
                html += `
                    <div class="test-section">
                        <div class="test-result ${className}">
                            <strong>${icon} ${testName}</strong>
                            <div style="margin-top: 5px; font-size: 0.9em;">
                                ${result.details}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            if (html === '') {
                html = '<div class="test-section"><div class="test-result test-pending">No test results found. Python may not be executing.</div></div>';
            }
            
            resultsDiv.innerHTML = html;
            
            // Update summary
            const passRate = testCount > 0 ? Math.round((passed / testCount) * 100) : 0;
            summaryStats.innerHTML = `
                <div>Total: ${testCount} tests</div>
                <div style="color: #4ade80;">Passed: ${passed}</div>
                <div style="color: ${failed > 0 ? '#f87171' : '#4ade80'};">Failed: ${failed}</div>
                <div style="font-size: 1.2em; margin-top: 10px;">Success Rate: ${passRate}%</div>
            `;
            
            // Update summary background based on results
            const summary = document.getElementById('summary');
            if (failed === 0 && testCount > 0) {
                summary.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
            } else if (passed > failed) {
                summary.style.background = 'linear-gradient(135deg, #f59e0b 0%, #d97706 100%)';
            } else if (testCount > 0) {
                summary.style.background = 'linear-gradient(135deg, #ef4444 0%, #dc2626 100%)';
            }
        }
        
        // Start checking for results
        window.addEventListener('load', function() {
            setTimeout(displayTestResults, 500);
            setInterval(displayTestResults, 1000);
        });
    </script>

    <div style="text-align: center; margin: 30px 0; padding: 20px; background: rgba(0,0,0,0.05); border-radius: 8px;">
        <h3 style="color: #1a73e8;">ğŸ”— Navigation</h3>
        <p style="margin: 15px 0;">
            <a href="index.html" style="color: #1a73e8; text-decoration: none; margin: 0 10px;">â† Back to Test Index</a> |
            <a href="python_dom_test.html" style="color: #1a73e8; text-decoration: none; margin: 0 10px;">DOM Test â†’</a> |
            <a href="python_advanced_test.html" style="color: #1a73e8; text-decoration: none; margin: 0 10px;">Advanced Test â†’</a>
        </p>
    </div>

</body>
</html>
